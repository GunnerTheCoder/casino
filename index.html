<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GUNNER CASTLE AND CHATGPT CASINO WEBSITE</title>

<style>
/* 
========================================================
  GLOBAL STYLES & RESETS
========================================================
*/
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(to bottom right, #e1e9f0, #f8f9fa);
  color: #333;
  min-height: 100vh;
  margin: 0;
  padding: 0;
}

/* 
========================================================
  HEADER & MAIN WRAPPER
========================================================
*/
header {
  background: #343a40;
  color: #fff;
  padding: 20px;
  text-align: center;
}

header h1 {
  font-size: 1.5rem;
  margin-bottom: 5px;
}

header p {
  font-size: 0.9rem;
  opacity: 0.8;
}

.main-content {
  max-width: 1000px;
  margin: 20px auto;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  overflow: hidden;
  display: flex;
  flex-direction: row;
}

/* 
========================================================
  SIDEBAR NAV (TABS)
========================================================
*/
.sidebar {
  width: 200px;
  background: #f1f3f5;
  border-right: 1px solid #dee2e6;
}

.sidebar ul {
  list-style: none;
}

.sidebar li {
  border-bottom: 1px solid #dee2e6;
}

.sidebar li a {
  display: block;
  padding: 15px;
  text-decoration: none;
  color: #333;
  font-weight: 500;
  transition: background 0.3s;
}

.sidebar li a:hover,
.sidebar li a.active {
  background: #ced4da;
}

/* 
========================================================
  TAB CONTENT AREA
========================================================
*/
.content {
  flex: 1;
  padding: 20px;
}

/* Hide all tab sections by default */
.tab-section {
  display: none;
}

/* 
========================================================
  GENERAL BUTTON & INPUT STYLES
========================================================
*/
button {
  padding: 8px 14px;
  margin: 5px 0;
  cursor: pointer;
  border: none;
  border-radius: 4px;
  background: #007bff;
  color: #fff;
  font-size: 14px;
  transition: background 0.3s;
}

button:hover {
  background: #0056b3;
}

input[type="file"],
input[type="number"],
select {
  margin: 5px 0;
  padding: 6px 8px;
  font-size: 14px;
  border-radius: 4px;
  border: 1px solid #ccc;
  width: auto;
}

input[type="number"] {
  width: 80px;
}

/* 
========================================================
  LOAD/SAVE TAB STYLES
========================================================
*/
#loadMessage {
  margin-top: 10px;
  font-weight: bold;
  color: red;
}

.save-file-section {
  margin-top: 20px;
  background: #f8f9fa;
  padding: 15px;
  border-radius: 6px;
  border: 1px solid #dee2e6;
}

/* 
========================================================
  GAMES COMMON STYLES
========================================================
*/
.game-box {
  margin-top: 20px;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 6px;
  border: 1px solid #dee2e6;
}

.game-box h3 {
  margin-bottom: 10px;
}

.status-message {
  margin-top: 10px;
  font-weight: bold;
}

.disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* 
========================================================
  BLACKJACK SPECIFIC STYLES
========================================================
*/
.cards {
  margin-top: 10px;
}

.card {
  display: inline-block;
  padding: 5px 8px;
  margin: 0 3px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: #fff;
  font-size: 0.9rem;
}

/* 
========================================================
  ROULETTE SPECIFIC STYLES
========================================================
*/
#rouletteResult {
  margin-top: 10px;
  font-weight: bold;
}

/* 
========================================================
  SLOTS SPECIFIC STYLES
========================================================
*/
#slotsReels {
  margin-top: 10px;
  font-size: 1.2rem;
}

#slotsResult {
  margin-top: 10px;
  font-weight: bold;
}

/* 
========================================================
  MEDIA QUERIES
========================================================
*/
@media (max-width: 768px) {
  .main-content {
    flex-direction: column;
  }
  .sidebar {
    width: 100%;
    display: flex;
    border-right: none;
    border-bottom: 1px solid #dee2e6;
  }
  .sidebar ul {
    display: flex;
    flex-wrap: wrap;
  }
  .sidebar li {
    flex: 1 1 auto;
    border-bottom: none;
    border-right: 1px solid #dee2e6;
  }
  .sidebar li:last-child {
    border-right: none;
  }
}

/* 
========================================================
  TRANSITIONS / ANIMATIONS (Basic)
========================================================
*/
.fade-in {
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>
</head>
<body>

<!-- 
========================================================
  HEADER
========================================================
-->
<header>
  <h1>GUNNER CASTLE AND CHATGPT CASINO WEBSITE</h1>
  <p>A Fun Demo Casino with Blackjack, Roulette, and Slots</p>
</header>

<!-- 
========================================================
  MAIN CONTENT WRAPPER
========================================================
-->
<div class="main-content">

  <!-- 
  ========================================================
    SIDEBAR (TABS NAVIGATION)
  ========================================================
  -->
  <nav class="sidebar">
    <ul>
      <li><a href="#" class="tablink active" data-tab="tabLoadSave">Load/Save</a></li>
      <li><a href="#" class="tablink" data-tab="tabBlackjack">Blackjack</a></li>
      <li><a href="#" class="tablink" data-tab="tabRoulette">Roulette</a></li>
      <li><a href="#" class="tablink" data-tab="tabSlots">Slots</a></li>
    </ul>
  </nav>

  <!-- 
  ========================================================
    CONTENT AREA
  ========================================================
  -->
  <div class="content">

    <!-- 
    ======================================================
      TAB: LOAD / SAVE
    ======================================================
    -->
    <div id="tabLoadSave" class="tab-section fade-in" style="display: block;">
      <h2>Load/Save Your Game</h2>
      <p>
        To begin, upload a valid save file that contains matching values for 
        <code>Money:</code>, <code>Gold:</code>, and <code>$:</code>. 
        If these values do not match, the game will refuse to load.
      </p>

      <div class="save-file-section">
        <h3>Upload Save File</h3>
        <input type="file" id="saveFileInput" accept=".txt,.hex">
        <button id="loadSaveBtn">Load Save</button>
        <p id="loadMessage"></p>
      </div>

      <div class="save-file-section" style="margin-top: 30px;">
        <h3>Download Save File</h3>
        <p>
          Once you've played, you can download a new save file. 
          This file will keep <code>Money:</code>, <code>Gold:</code>, and 
          <code>$:</code> in sync with your current balance.
        </p>
        <button id="downloadSaveBtn" disabled>Download Save File</button>
      </div>

    </div>

    <!-- 
    ======================================================
      TAB: BLACKJACK
    ======================================================
    -->
    <div id="tabBlackjack" class="tab-section fade-in">
      <h2>Blackjack</h2>
      <p>
        Current Balance: <strong><span id="moneyDisplayBlackjack">0</span></strong>
      </p>

      <div class="game-box">
        <h3>Play Blackjack</h3>
        <div>
          <label>Bet Amount: 
            <input type="number" id="blackjackBet" value="10" min="1">
          </label>
          <button id="blackjackDealBtn">Deal</button>
          <button id="blackjackHitBtn" disabled>Hit</button>
          <button id="blackjackStandBtn" disabled>Stand</button>
        </div>
        <div id="blackjackStatus" class="status-message"></div>
        <div class="cards">
          <div>Player Cards: 
            <span id="playerCards"></span> 
            | <strong>Total:</strong> <span id="playerTotal">0</span>
          </div>
          <div>Dealer Cards: 
            <span id="dealerCards"></span> 
            | <strong>Total:</strong> <span id="dealerTotal">0</span>
          </div>
        </div>
      </div>
    </div>

    <!-- 
    ======================================================
      TAB: ROULETTE
    ======================================================
    -->
    <div id="tabRoulette" class="tab-section fade-in">
      <h2>Roulette</h2>
      <p>
        Current Balance: <strong><span id="moneyDisplayRoulette">0</span></strong>
      </p>

      <div class="game-box">
        <h3>Play Roulette</h3>
        <div>
          <label>Bet Amount: 
            <input type="number" id="rouletteBet" value="10" min="1">
          </label>
          <label>Bet on:
            <select id="rouletteChoice">
              <option value="red">Red</option>
              <option value="black">Black</option>
              <option value="0">0</option>
            </select>
          </label>
          <button id="rouletteSpinBtn">Spin</button>
        </div>
        <div id="rouletteResult"></div>
      </div>
    </div>

    <!-- 
    ======================================================
      TAB: SLOTS
    ======================================================
    -->
    <div id="tabSlots" class="tab-section fade-in">
      <h2>Slots</h2>
      <p>
        Current Balance: <strong><span id="moneyDisplaySlots">0</span></strong>
      </p>

      <div class="game-box">
        <h3>Play Slots</h3>
        <div>
          <label>Bet Amount: 
            <input type="number" id="slotsBet" value="10" min="1">
          </label>
          <button id="slotsSpinBtn">Spin</button>
        </div>
        <div id="slotsReels">[ ? ] [ ? ] [ ? ]</div>
        <div id="slotsResult"></div>
      </div>
    </div>

  </div> <!-- end .content -->

</div> <!-- end .main-content -->


<script>
/* 
================================================================================
  GLOBAL VARIABLES & STATE
================================================================================
*/
let playerMoney = 0;   // The player's current money, loaded from the save file
let isSaveLoaded = false; // Whether a valid save file has been loaded

// We will display the player's money in each tab for convenience
// (Blackjack, Roulette, Slots).
// We'll update these displays whenever playerMoney changes.
const moneyDisplayBlackjack = document.getElementById('moneyDisplayBlackjack');
const moneyDisplayRoulette  = document.getElementById('moneyDisplayRoulette');
const moneyDisplaySlots     = document.getElementById('moneyDisplaySlots');

// File input & message
const saveFileInput = document.getElementById('saveFileInput');
const loadSaveBtn   = document.getElementById('loadSaveBtn');
const loadMessage   = document.getElementById('loadMessage');

// Download button
const downloadSaveBtn = document.getElementById('downloadSaveBtn');

// 
// TABLINKS & TAB SECTIONS
//
const tabLinks = document.querySelectorAll('.tablink');
const tabSections = document.querySelectorAll('.tab-section');

// 
// GAME-SPECIFIC ELEMENTS
//

// Blackjack
let deck = [];
let playerCards = [];
let dealerCards = [];

const blackjackBetInput    = document.getElementById('blackjackBet');
const blackjackDealBtn     = document.getElementById('blackjackDealBtn');
const blackjackHitBtn      = document.getElementById('blackjackHitBtn');
const blackjackStandBtn    = document.getElementById('blackjackStandBtn');
const blackjackStatus      = document.getElementById('blackjackStatus');
const playerCardsSpan      = document.getElementById('playerCards');
const dealerCardsSpan      = document.getElementById('dealerCards');
const playerTotalSpan      = document.getElementById('playerTotal');
const dealerTotalSpan      = document.getElementById('dealerTotal');

// Suits and ranks for Blackjack
const suits = ["♠","♥","♦","♣"];
const ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

// Roulette
const rouletteBetInput   = document.getElementById('rouletteBet');
const rouletteChoiceSelect = document.getElementById('rouletteChoice');
const rouletteSpinBtn    = document.getElementById('rouletteSpinBtn');
const rouletteResult     = document.getElementById('rouletteResult');

// Slots
const slotsBetInput      = document.getElementById('slotsBet');
const slotsSpinBtn       = document.getElementById('slotsSpinBtn');
const slotsReels         = document.getElementById('slotsReels');
const slotsResult        = document.getElementById('slotsResult');
const symbols            = ["🍒","🍋","🔔","⭐","🍀"];


/* 
================================================================================
  TAB NAVIGATION LOGIC
================================================================================
*/
tabLinks.forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    
    // Remove 'active' class from all links
    tabLinks.forEach(l => l.classList.remove('active'));
    // Hide all tab sections
    tabSections.forEach(sec => sec.style.display = 'none');

    // Add 'active' class to clicked link
    link.classList.add('active');
    // Show the corresponding tab section
    const tabId = link.getAttribute('data-tab');
    const targetTab = document.getElementById(tabId);
    if (targetTab) {
      targetTab.style.display = 'block';
    }
  });
});


/* 
================================================================================
  LOAD SAVE FILE LOGIC
================================================================================
*/

/**
 * parseSaveFile(contents)
 * Parses the text contents of the save file to extract 
 *   Money:<number>
 *   Gold:<number>
 *   $:<number>
 * If all three match, returns that numeric value; otherwise returns null.
 */
function parseSaveFile(contents) {
  const moneyMatch  = contents.match(/Money:(\d+)/);
  const goldMatch   = contents.match(/Gold:(\d+)/);
  const dollarMatch = contents.match(/\$:(\d+)/);

  if (!moneyMatch || !goldMatch || !dollarMatch) {
    return null;
  }

  const moneyVal  = parseInt(moneyMatch[1], 10);
  const goldVal   = parseInt(goldMatch[1], 10);
  const dollarVal = parseInt(dollarMatch[1], 10);

  if (moneyVal !== goldVal || goldVal !== dollarVal) {
    return null;
  }

  return moneyVal;
}

/**
 * createSaveFileContent(moneyValue)
 * Returns the string content of the save file, with all 
 * three lines matching the given moneyValue.
 */
function createSaveFileContent(moneyValue) {
  // If you wanted to mimic a hex editor's ASCII region, you could add
  // more lines or padding. For now, we'll keep it simple:
  return (
`GUNNER CASTLE AND CHATGPT CASINO WEBSITE
Money:${moneyValue}
Gold:${moneyValue}
$:${moneyValue}
`
  );
}

// Handle "Load Save" button
loadSaveBtn.addEventListener('click', () => {
  const file = saveFileInput.files && saveFileInput.files[0];
  if (!file) {
    loadMessage.textContent = "Please select a file first.";
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    const contents = e.target.result;
    const moneyVal = parseSaveFile(contents);
    if (moneyVal === null) {
      loadMessage.textContent = "Error: Money, Gold, and $ do not match or file format invalid.";
      isSaveLoaded = false;
      // Disable the download button since no valid save
      downloadSaveBtn.disabled = true;
    } else {
      loadMessage.textContent = "Save file loaded successfully!";
      isSaveLoaded = true;
      playerMoney = moneyVal;
      updateMoneyDisplays();
      downloadSaveBtn.disabled = false;
    }
  };
  reader.readAsText(file);
});

// Handle "Download Save File" button
downloadSaveBtn.addEventListener('click', () => {
  if (!isSaveLoaded) {
    alert("No valid save loaded yet. Please load a valid save first.");
    return;
  }
  const fileContents = createSaveFileContent(playerMoney);
  const blob = new Blob([fileContents], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);

  const link = document.createElement('a');
  link.href = url;
  link.download = "GunnerCastleChatGPTCasino.hex";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  URL.revokeObjectURL(url);
});

/* 
================================================================================
  MONEY DISPLAY & UPDATING
================================================================================
*/
function updateMoneyDisplays() {
  moneyDisplayBlackjack.textContent = playerMoney;
  moneyDisplayRoulette.textContent  = playerMoney;
  moneyDisplaySlots.textContent     = playerMoney;
}


/* 
================================================================================
  BLACKJACK LOGIC
================================================================================
*/

/**
 * initDeck()
 * Initializes and shuffles the deck of 52 cards.
 */
function initDeck() {
  deck = [];
  for (let s of suits) {
    for (let r of ranks) {
      deck.push({ suit: s, rank: r });
    }
  }
  // Shuffle
  for (let i = deck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
}

/**
 * getCardValue(card)
 * Returns the numeric value of a single card object.
 * A = 11 (adjusted later), J/Q/K = 10, numeric for others.
 */
function getCardValue(card) {
  if (card.rank === "A") return 11; 
  if (["J","Q","K"].includes(card.rank)) return 10;
  return parseInt(card.rank, 10);
}

/**
 * calculateTotal(cards)
 * Returns the best total for the given set of cards 
 * (handling Aces as 1 or 11).
 */
function calculateTotal(cards) {
  let total = 0;
  let aceCount = 0;
  for (let c of cards) {
    total += getCardValue(c);
    if (c.rank === "A") aceCount++;
  }
  // Adjust for aces if over 21
  while (total > 21 && aceCount > 0) {
    total -= 10;
    aceCount--;
  }
  return total;
}

/**
 * renderHands()
 * Updates the UI to show the player's and dealer's cards & totals.
 */
function renderHands() {
  playerCardsSpan.textContent = playerCards.map(c => c.rank + c.suit).join(" ");
  dealerCardsSpan.textContent = dealerCards.map(c => c.rank + c.suit).join(" ");
  playerTotalSpan.textContent = calculateTotal(playerCards);
  dealerTotalSpan.textContent = calculateTotal(dealerCards);
}

/**
 * endBlackjackRound(message)
 * Displays the result message and updates player money accordingly.
 */
function endBlackjackRound(message) {
  const bet = parseInt(blackjackBetInput.value, 10);
  const playerTotal = calculateTotal(playerCards);
  const dealerTotal = calculateTotal(dealerCards);

  // Determine if player won, lost, or push
  if (message.includes("You win")) {
    playerMoney += bet;
  } else if (message.includes("lose") || message.includes("Dealer wins")) {
    playerMoney -= bet;
  }
  // If it's a push, no money changes

  updateMoneyDisplays();
  blackjackStatus.textContent = message;

  // Enable/disable buttons
  blackjackHitBtn.disabled   = true;
  blackjackStandBtn.disabled = true;
  blackjackDealBtn.disabled  = false;
}

/**
 * Event: Deal Button
 */
blackjackDealBtn.addEventListener('click', () => {
  if (!isSaveLoaded) {
    alert("Please load a valid save file first!");
    return;
  }

  const bet = parseInt(blackjackBetInput.value, 10);
  if (bet <= 0 || bet > playerMoney) {
    alert("Invalid bet amount!");
    return;
  }

  initDeck();
  playerCards = [deck.pop(), deck.pop()];
  dealerCards = [deck.pop(), deck.pop()];

  blackjackHitBtn.disabled   = false;
  blackjackStandBtn.disabled = false;
  blackjackDealBtn.disabled  = true;
  blackjackStatus.textContent = "";

  renderHands();
});

/**
 * Event: Hit Button
 */
blackjackHitBtn.addEventListener('click', () => {
  playerCards.push(deck.pop());
  renderHands();

  const total = calculateTotal(playerCards);
  if (total > 21) {
    endBlackjackRound("Bust! You lose.");
  }
});

/**
 * Event: Stand Button
 */
blackjackStandBtn.addEventListener('click', () => {
  // Dealer's turn
  while (calculateTotal(dealerCards) < 17) {
    dealerCards.push(deck.pop());
  }
  renderHands();

  const playerTotal = calculateTotal(playerCards);
  const dealerTotal = calculateTotal(dealerCards);

  if (dealerTotal > 21) {
    endBlackjackRound("Dealer busts! You win.");
  } else if (playerTotal > dealerTotal) {
    endBlackjackRound("You win!");
  } else if (playerTotal < dealerTotal) {
    endBlackjackRound("Dealer wins.");
  } else {
    endBlackjackRound("Push (tie).");
  }
});


/* 
================================================================================
  ROULETTE LOGIC
================================================================================
*/

/**
 * Event: Spin Button
 */
rouletteSpinBtn.addEventListener('click', () => {
  if (!isSaveLoaded) {
    alert("Please load a valid save file first!");
    return;
  }

  const bet = parseInt(rouletteBetInput.value, 10);
  if (bet <= 0 || bet > playerMoney) {
    alert("Invalid bet amount!");
    return;
  }
  const choice = rouletteChoiceSelect.value; // 'red', 'black', or '0'

  // Spin result: number 0-36
  const spinNumber = Math.floor(Math.random() * 37);
  let spinColor = "green"; // default for 0
  if (spinNumber > 0) {
    // Simplify color assignment: even=black, odd=red
    spinColor = (spinNumber % 2 === 0) ? "black" : "red";
  }

  let outcome = `Spin: ${spinNumber} (${spinColor}) - You lose.`;
  let won = false;

  if (choice === "0") {
    if (spinNumber === 0) {
      won = true;
    }
  } else {
    // 'red' or 'black'
    if (spinColor === choice) {
      won = true;
    }
  }

  if (won) {
    if (choice === "0") {
      // Single number bet typically pays 35:1
      playerMoney += bet * 35;
      outcome = `Spin: ${spinNumber} (green) - You WON $${bet * 35}!`;
    } else {
      // Simple color bet pays 1:1
      playerMoney += bet;
      outcome = `Spin: ${spinNumber} (${spinColor}) - You WON $${bet}!`;
    }
  } else {
    playerMoney -= bet;
  }

  updateMoneyDisplays();
  rouletteResult.textContent = outcome;
});


/* 
================================================================================
  SLOTS LOGIC
================================================================================
*/

/**
 * Event: Spin Button
 */
slotsSpinBtn.addEventListener('click', () => {
  if (!isSaveLoaded) {
    alert("Please load a valid save file first!");
    return;
  }

  const bet = parseInt(slotsBetInput.value, 10);
  if (bet <= 0 || bet > playerMoney) {
    alert("Invalid bet amount!");
    return;
  }

  // Spin reels
  const reel1 = symbols[Math.floor(Math.random() * symbols.length)];
  const reel2 = symbols[Math.floor(Math.random() * symbols.length)];
  const reel3 = symbols[Math.floor(Math.random() * symbols.length)];
  slotsReels.textContent = `[ ${reel1} ] [ ${reel2} ] [ ${reel3} ]`;

  // Evaluate outcome
  if (reel1 === reel2 && reel2 === reel3) {
    // Three of a kind: 5x
    const winAmount = bet * 5;
    playerMoney += winAmount;
    slotsResult.textContent = `Jackpot! You won $${winAmount}.`;
  } else if (reel1 === reel2 || reel2 === reel3 || reel1 === reel3) {
    // Two of a kind: 2x
    const winAmount = bet * 2;
    // Net gain is bet
    playerMoney += (winAmount - bet);
    slotsResult.textContent = `Two of a kind! You won $${winAmount}.`;
  } else {
    // Lose
    playerMoney -= bet;
    slotsResult.textContent = `No match! You lost $${bet}.`;
  }

  updateMoneyDisplays();
});

</script>
</body>
</html>
